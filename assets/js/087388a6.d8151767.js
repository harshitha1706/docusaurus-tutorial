"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[2468],{7820:(e,a,s)=>{s.r(a),s.d(a,{assets:()=>d,contentTitle:()=>l,default:()=>p,frontMatter:()=>o,metadata:()=>t,toc:()=>i});const t=JSON.parse('{"id":"pyspark-program-samples","title":"pyspark-program-samples","description":"Sample pyspark programs","source":"@site/docs/pyspark-program-samples.md","sourceDirName":".","slug":"/pyspark-program-samples","permalink":"/docusaurus-tutorial/docs/pyspark-program-samples","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/pyspark-program-samples.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Gold","permalink":"/docusaurus-tutorial/docs/Gold"}}');var r=s(4848),n=s(8453);const o={},l=void 0,d={},i=[{value:"Sample pyspark programs",id:"sample-pyspark-programs",level:3},{value:"1.To read table",id:"1to-read-table",level:3},{value:"Below are some sample programs",id:"below-are-some-sample-programs",level:3},{value:"2.Checked sql query",id:"2checked-sql-query",level:3},{value:"3.To show sample datasets list",id:"3to-show-sample-datasets-list",level:3},{value:"4.Create dataframe to retail datasets",id:"4create-dataframe-to-retail-datasets",level:3},{value:"5.Used cast and with column to change the column datatype",id:"5used-cast-and-with-column-to-change-the-column-datatype",level:3}];function c(e){const a={admonition:"admonition",code:"code",h3:"h3",p:"p",pre:"pre",...(0,n.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.h3,{id:"sample-pyspark-programs",children:"Sample pyspark programs"}),"\n",(0,r.jsx)(a.p,{children:"This simple code example queries the specified table and then shows the specified table's first 5 rows. To use a different table, adjust the call to spark.read.table."}),"\n",(0,r.jsx)(a.h3,{id:"1to-read-table",children:"1.To read table"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-Python",children:'\r\nfrom databricks.connect import DatabricksSession\r\n\r\nspark = DatabricksSession.builder.getOrCreate()\r\n\r\ndf = spark.read.table("samples.nyctaxi.trips")\r\ndf.show(5)\n'})}),"\n",(0,r.jsx)(a.admonition,{type:"tip",children:(0,r.jsx)(a.p,{children:"Can write programs in SQL, Python, R by using magic commands"})}),"\n",(0,r.jsx)(a.h3,{id:"below-are-some-sample-programs",children:"Below are some sample programs"}),"\n",(0,r.jsx)(a.h3,{id:"2checked-sql-query",children:"2.Checked sql query"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-sql",children:'%sql\r\nselect "I\'m running sql"\n'})}),"\n",(0,r.jsx)(a.h3,{id:"3to-show-sample-datasets-list",children:"3.To show sample datasets list"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-python",children:'display(dbutils.fs.ls("/databricks-datasets/"))\n'})}),"\n",(0,r.jsx)(a.h3,{id:"4create-dataframe-to-retail-datasets",children:"4.Create dataframe to retail datasets"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-python",children:'df1 = spark.read.option("header", True).csv("dbfs:/databricks-datasets/online_retail/data-001/data.csv")\r\n\n'})}),"\n",(0,r.jsx)(a.h3,{id:"5used-cast-and-with-column-to-change-the-column-datatype",children:"5.Used cast and with column to change the column datatype"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-python",children:'from pyspark.sql.functions import col\r\ndf = df1.withColumn("InvoiceNo",df1["InvoiceNo"].cast("int"))\n'})})]})}function p(e={}){const{wrapper:a}={...(0,n.R)(),...e.components};return a?(0,r.jsx)(a,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},8453:(e,a,s)=>{s.d(a,{R:()=>o,x:()=>l});var t=s(6540);const r={},n=t.createContext(r);function o(e){const a=t.useContext(n);return t.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function l(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),t.createElement(n.Provider,{value:a},e.children)}}}]);